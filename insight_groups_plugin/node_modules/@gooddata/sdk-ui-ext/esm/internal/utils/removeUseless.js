// (C) 2022 GoodData Corporation
import compact from "lodash/fp/compact";
import filter from "lodash/fp/filter";
import flow from "lodash/fp/flow";
import fromPairs from "lodash/fromPairs";
import isArray from "lodash/isArray";
import isEmpty from "lodash/isEmpty";
import isNil from "lodash/isNil";
import isObject from "lodash/isObject";
import map from "lodash/fp/map";
import toPairs from "lodash/toPairs";
function isUseless(obj) {
    return isNil(obj) || (isObject(obj) && isEmpty(obj));
}
/**
 * For a given object returns a copy that has all properties that are empty objects or arrays or nil removed.
 * This is applied recursively.
 *
 * @param obj - object to handle
 * @returns always a new instance if obj is not scalar
 */
export function removeUseless(obj) {
    var res = obj;
    if (isArray(obj)) {
        res = flow(map(removeUseless), compact)(obj);
    }
    else if (isObject(obj)) {
        res = flow(toPairs, map(function (_a) {
            var key = _a[0], value = _a[1];
            return [key, removeUseless(value)];
        }), filter(function (_a) {
            var _ = _a[0], value = _a[1];
            return !isUseless(value);
        }), fromPairs)(obj);
    }
    return isUseless(res) ? undefined : res;
}
//# sourceMappingURL=removeUseless.js.map