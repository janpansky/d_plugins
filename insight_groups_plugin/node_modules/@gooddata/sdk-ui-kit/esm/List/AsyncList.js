// (C) 2007-2022 GoodData Corporation
import React, { useCallback } from "react";
import cx from "classnames";
import ContentLoader from "react-content-loader";
import { LoadingMask } from "../LoadingMask";
import { List } from "./List";
/**
 * @internal
 */
export function AsyncList(props) {
    var className = props.className, width = props.width, height = props.height, items = props.items, itemHeight = props.itemHeight, renderItem = props.renderItem, isLoading = props.isLoading, _a = props.nextPageItemPlaceholdersCount, nextPageItemPlaceholdersCount = _a === void 0 ? 0 : _a, isLoadingNextPage = props.isLoadingNextPage, onLoadNextPage = props.onLoadNextPage;
    var itemRenderer = useCallback(function (renderItemProps) {
        if (renderItemProps.rowIndex + 1 > items.length) {
            return React.createElement(LoadingPlaceholder, null);
        }
        return renderItem(renderItemProps);
    }, [items, renderItem]);
    var handleScrollEnd = useCallback(function (_, endRowIndex) {
        if (endRowIndex > items.length && !isLoadingNextPage) {
            onLoadNextPage === null || onLoadNextPage === void 0 ? void 0 : onLoadNextPage();
        }
    }, [items, isLoadingNextPage, onLoadNextPage]);
    return isLoading ? (React.createElement(LoadingMask, { height: props.height })) : (React.createElement(List, { className: cx("gd-async-list", className ? className : ""), width: width, height: height, items: items, itemHeight: itemHeight, itemsCount: items.length + nextPageItemPlaceholdersCount, renderItem: itemRenderer, onScrollEnd: handleScrollEnd }));
}
function LoadingPlaceholder() {
    return (React.createElement("div", { className: "gd-list-item gd-list-item-not-loaded" },
        React.createElement(ContentLoader, { viewBox: "0 0 250 28" },
            React.createElement("rect", { x: "0", y: "7", rx: "3", ry: "3", width: "13", height: "13" }),
            React.createElement("rect", { x: "22", y: "7", rx: "3", ry: "3", width: "250", height: "13" }))));
}
//# sourceMappingURL=AsyncList.js.map