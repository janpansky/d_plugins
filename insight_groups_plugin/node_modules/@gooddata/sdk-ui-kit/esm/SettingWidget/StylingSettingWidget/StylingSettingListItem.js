// (C) 2022 GoodData Corporation
import { __read } from "tslib";
import React, { useState } from "react";
import { useIntl } from "react-intl";
import cx from "classnames";
import { stringUtils } from "@gooddata/util";
import { ShortenedText } from "../../ShortenedText";
import { ColorPreview } from "../../Dialog";
import { Menu } from "../../Menu";
import { Item, ItemsWrapper, Separator } from "../../List";
import { Button } from "../../Button";
import { Bubble, BubbleHoverTrigger } from "../../Bubble";
import noop from "lodash/noop";
var TEXT_TOOLTIP_ALIGN_POINTS = [
    { align: "tc bc", offset: { x: 0, y: 0 } },
    { align: "bc tc", offset: { x: 0, y: 0 } },
];
export var StylingSettingListItem = function (_a) {
    var item = _a.item, itemToColorPreview = _a.itemToColorPreview, isSelected = _a.isSelected, isDeletable = _a.isDeletable, onClick = _a.onClick, onEdit = _a.onEdit, onDelete = _a.onDelete, _b = _a.onMenuToggle, onMenuToggle = _b === void 0 ? noop : _b;
    var intl = useIntl();
    var name = item.name, ref = item.ref, content = item.content;
    var colorsPreview = itemToColorPreview(content);
    var _c = __read(useState(false), 2), opened = _c[0], setOpened = _c[1];
    var onOpenedChange = function (_a) {
        var opened = _a.opened;
        return setOpened(opened);
    };
    var toggleMenu = function () {
        onMenuToggle(ref);
        setOpened(!opened);
    };
    var isMenuVisible = onEdit || onDelete;
    return (React.createElement("div", { className: cx("gd-styling-picker-list-item", "s-styling-picker-list-item", "s-styling-picker-list-item-" + stringUtils.simplifyText(name), {
            "is-selected": isSelected,
        }) },
        React.createElement("label", { className: "input-radio-label gd-styling-picker-list-item-content" },
            React.createElement("input", { "aria-label": stringUtils.simplifyText(name), type: "radio", className: "input-radio", readOnly: true, checked: isSelected, onClick: function () { return onClick(ref); } }),
            React.createElement(ColorPreview, { className: "gd-styling-picker-list-item-colors", colors: colorsPreview }),
            React.createElement("span", { className: "input-label-text gd-styling-picker-list-item-text" },
                React.createElement(ShortenedText, { className: "gd-styling-picker-list-item-text-shortened", tooltipAlignPoints: TEXT_TOOLTIP_ALIGN_POINTS }, name))),
        isMenuVisible ? (React.createElement(Menu, { toggler: React.createElement(Button, { value: "...", className: "gd-button-link-dimmed gd-styling-item-menu s-menu-toggle", onClick: toggleMenu }), opened: opened, openAction: "click", closeOnScroll: true, onOpenedChange: onOpenedChange },
            React.createElement(ItemsWrapper, { className: "s-styling-item-menu-items", smallItemsSpacing: true },
                React.createElement(Item, { className: "s-styling-item-menu-item-edit", onClick: function () { return onEdit === null || onEdit === void 0 ? void 0 : onEdit(item); } }, intl.formatMessage({ id: "stylingPicker.item.edit" })),
                React.createElement(Separator, null),
                React.createElement(Item, { className: "s-styling-item-menu-item-delete", onClick: function () { return isDeletable && (onDelete === null || onDelete === void 0 ? void 0 : onDelete(ref)); }, disabled: !isDeletable },
                    React.createElement(BubbleHoverTrigger, { showDelay: 0, hideDelay: 0 },
                        intl.formatMessage({ id: "stylingPicker.item.delete" }),
                        !isDeletable ? (React.createElement(Bubble, { className: "bubble-primary" }, intl.formatMessage({ id: "stylingPicker.item.delete.tooltip" }))) : null))))) : null));
};
//# sourceMappingURL=StylingSettingListItem.js.map